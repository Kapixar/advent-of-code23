<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>11</title>
</head>

<body>
    <script type="module">
        const fileUrl = '1_1.txt' // provide file location

        const raw = await fetch(fileUrl)
        const content = await raw.text()
        const lines = content.split('\n')

        const sum1 = lines.reduce((acc, line) => {
            let first = null, last = null;
            for(let i = 0; i < line.length; i++) {
                if(!first && !isNaN(parseInt(line[i])) ) first = line[i]
                if(!last && !isNaN(parseInt(line[line.length - i - 1]))) last = line[line.length - i - 1]
            }
            // console.log(line);
            // console.log("first", first,"last", last, parseInt(first + last))
            return acc + parseInt(first + last)
        }, 0)
        console.log(sum1); 

        const dict = {
            "one": "1",
            "two": "2",
            "three": "3",
            "four": "4",
            "five": "5",
            "six": "6",
            "seven": "7",
            "eight": "8",
            "nine": "9",
        }

        console.log(lines);

        const sum2 = lines.reduce((acc, line) => {
            const matches = line.matchAll(/(?=(1|2|3|4|5|6|7|8|9|one|two|three|four|five|six|seven|eight|nine))/g) ?? [];
            let stringMatches = Array.from(matches, (m) => m[1]);
            console.log(line);
            console.log(stringMatches);

            let first = isNaN(parseInt(stringMatches[0])) ? dict[stringMatches[0]] : stringMatches[0];
            let last = isNaN(parseInt(stringMatches[stringMatches.length - 1])) ? dict[stringMatches[stringMatches.length - 1]] : stringMatches[stringMatches.length - 1];
            
            console.log("first", first,"last", last, parseInt(first + last));
            return acc + parseInt(first + last);
        }, 0)

        // const sum2 = linesRefactor.reduce((acc, line) => {
        //     let first = null, last = null;
        //     for(let i = 0; i < line.length; i++) {
        //         if(!first && !isNaN(parseInt(line[i])) ) first = line[i]
        //         if(!last && !isNaN(parseInt(line[line.length - i - 1]))) last = line[line.length - i - 1]
        //     }
        //     console.log(line);
        //     console.log("first", first,"last", last, parseInt(first + last))
        //     return acc + parseInt(first + last)
        // }, 0)

        console.log(sum2); 
    </script>
</body>

</html>